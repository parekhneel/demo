<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>src.run_pipeline API documentation</title>
<meta name="description" content="This script allows users to run the database connection and model pipeline." />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>src.run_pipeline</code></h1>
</header>
<section id="section-intro">
<p>This script allows users to run the database connection and model pipeline.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
This script allows users to run the database connection and model pipeline.
&#34;&#34;&#34;

####################################### IMPORTS #######################################
from dataclasses import dataclass
from enum import Enum
import os

from .utils import fetch_version_hash


####################################### CONFIG CLASSES #######################################
class DBs(Enum):
    &#39;&#39;&#39;
    the connection url for each database type
    &#39;&#39;&#39;
    EDW = &#39;datasunrise01.aws2.teladoc.com&#39;
    REDSHIFT = &#39;redshift.prod.livongo.com&#39;

@dataclass
class ModelConfig():
    &#39;&#39;&#39;
    This one show how you might choose to intake model configuration parameters at run time.

    Attributes
    ----------
    learning_rate: float = 1e-3
        defaults to 1e-3 since we observed best results
    environment = &#39;databricks&#39;
        this is the environment in which you&#39;re running the experiment (eg databricks, local, etc)
    experiment_name: str = None
        Use this to name your experiment and append a string to a file name. TODO: check if valid
        file naming convention
    start_date = &#39;2020-01-01&#39;
        the YYYY-MM-DD that the training data starts
    save_path: str = &#39;/Users/neel.parekh/Desktop/examples/&#39;
        where all of the outputs will live. TODO: Update all path managing to pathlib
    &#39;&#39;&#39;

    learning_rate: float = 1e-3
    environment: str = &#39;databricks&#39;
    experiment_name: str = None
    start_date: str = &#39;2020-01-01&#39;
    save_path: str = &#39;./models/&#39;

    @property
    def model_path(self) -&gt; str:
        &#39;&#39;&#39;
        Construct the model output file name as a property

        Parameters
        ----------

        Returns
        -------
        model_path: str
            where the model will be saved on the file system
        &#39;&#39;&#39;
        file_name = &#39;_&#39;.join(
            [str(item) for item in [
                    self.environment,
                    self.experiment_name,
                    self.start_date
                ]
            ]
        )
        model_path = self.save_path + file_name + &#39;.model&#39;
        return model_path

@dataclass
class DatabaseConfig():
    &#39;&#39;&#39;
    This is an example of how you might connect to one of the Teladoc databases. Still
    need to add function that will help access tables from the database, verifying table
    names are appropriately specified.

    Attributes
    ----------
    db_name: DBs
        this must be a selection of one of the enumerated `DBs` type
    entities: list[str] = None
        which tables we wish to pull from
    &#39;&#39;&#39;
    db_name: DBs
    entities: list[str] = None

    # @property
    # def db_conn(self):
    #     &#39;&#39;&#39;
    #     WIP
    #     &#39;&#39;&#39;
    #     # code to create db connection here...
    #     pass


####################################### MAIN RUN #######################################
if __name__ == &#34;__main__&#34;:

    # Create the configs
    model_params = ModelConfig(
        learning_rate=1e-5,
        experiment_name=&#39;include_redshift_data&#39;
    )
    EDW = DatabaseConfig(
        db_name=DBs.EDW,
        entities=[&#39;food_logs&#39;, &#39;weight_logs&#39;, &#39;voice_coach_logs&#39;]
    )


    # Get the git commit used and save it along with the input config params
    # input_config = yaml.safe_load(open(sys.argv[1]))
    input_config = {}
    input_config[&#39;git_commit&#39;] = fetch_version_hash()

    # for debugging, print the outputs of the above configs
    print()
    print(f&#34;INPUT_CONFIG: {input_config}&#34;)
    print(f&#34;MODEL_SAVE_PATH: {os.path.abspath(model_params.model_path)}&#34;)
    print(f&#34;MODEL_PARAMS: {model_params}&#34;)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="src.run_pipeline.DBs"><code class="flex name class">
<span>class <span class="ident">DBs</span></span>
<span>(</span><span>value, names=None, *, module=None, qualname=None, type=None, start=1)</span>
</code></dt>
<dd>
<div class="desc"><p>the connection url for each database type</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DBs(Enum):
    &#39;&#39;&#39;
    the connection url for each database type
    &#39;&#39;&#39;
    EDW = &#39;datasunrise01.aws2.teladoc.com&#39;
    REDSHIFT = &#39;redshift.prod.livongo.com&#39;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>enum.Enum</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="src.run_pipeline.DBs.EDW"><code class="name">var <span class="ident">EDW</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="src.run_pipeline.DBs.REDSHIFT"><code class="name">var <span class="ident">REDSHIFT</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="src.run_pipeline.DatabaseConfig"><code class="flex name class">
<span>class <span class="ident">DatabaseConfig</span></span>
<span>(</span><span>db_name: <a title="src.run_pipeline.DBs" href="#src.run_pipeline.DBs">DBs</a>, entities: list = None)</span>
</code></dt>
<dd>
<div class="desc"><p>This is an example of how you might connect to one of the Teladoc databases. Still
need to add function that will help access tables from the database, verifying table
names are appropriately specified.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>db_name</code></strong> :&ensp;<code><a title="src.run_pipeline.DBs" href="#src.run_pipeline.DBs">DBs</a></code></dt>
<dd>this must be a selection of one of the enumerated <code><a title="src.run_pipeline.DBs" href="#src.run_pipeline.DBs">DBs</a></code> type</dd>
<dt><strong><code>entities</code></strong> :&ensp;<code>list[str] = None</code></dt>
<dd>which tables we wish to pull from</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@dataclass
class DatabaseConfig():
    &#39;&#39;&#39;
    This is an example of how you might connect to one of the Teladoc databases. Still
    need to add function that will help access tables from the database, verifying table
    names are appropriately specified.

    Attributes
    ----------
    db_name: DBs
        this must be a selection of one of the enumerated `DBs` type
    entities: list[str] = None
        which tables we wish to pull from
    &#39;&#39;&#39;
    db_name: DBs
    entities: list[str] = None

    # @property
    # def db_conn(self):
    #     &#39;&#39;&#39;
    #     WIP
    #     &#39;&#39;&#39;
    #     # code to create db connection here...
    #     pass</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="src.run_pipeline.DatabaseConfig.db_name"><code class="name">var <span class="ident">db_name</span> : <a title="src.run_pipeline.DBs" href="#src.run_pipeline.DBs">DBs</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="src.run_pipeline.DatabaseConfig.entities"><code class="name">var <span class="ident">entities</span> : list</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="src.run_pipeline.ModelConfig"><code class="flex name class">
<span>class <span class="ident">ModelConfig</span></span>
<span>(</span><span>learning_rate: float = 0.001, environment: str = 'databricks', experiment_name: str = None, start_date: str = '2020-01-01', save_path: str = './models/')</span>
</code></dt>
<dd>
<div class="desc"><p>This one show how you might choose to intake model configuration parameters at run time.</p>
<h2 id="attributes">Attributes</h2>
<dl>
<dt><strong><code>learning_rate</code></strong> :&ensp;<code>float = 1e-3</code></dt>
<dd>defaults to 1e-3 since we observed best results</dd>
<dt>environment = 'databricks'</dt>
<dt>this is the environment in which you're running the experiment (eg databricks, local, etc)</dt>
<dt><strong><code>experiment_name</code></strong> :&ensp;<code>str = None</code></dt>
<dd>Use this to name your experiment and append a string to a file name. TODO: check if valid
file naming convention</dd>
<dt>start_date = '2020-01-01'</dt>
<dt>the YYYY-MM-DD that the training data starts</dt>
<dt><strong><code>save_path</code></strong> :&ensp;<code>str = '/Users/neel.parekh/Desktop/examples/'</code></dt>
<dd>where all of the outputs will live. TODO: Update all path managing to pathlib</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@dataclass
class ModelConfig():
    &#39;&#39;&#39;
    This one show how you might choose to intake model configuration parameters at run time.

    Attributes
    ----------
    learning_rate: float = 1e-3
        defaults to 1e-3 since we observed best results
    environment = &#39;databricks&#39;
        this is the environment in which you&#39;re running the experiment (eg databricks, local, etc)
    experiment_name: str = None
        Use this to name your experiment and append a string to a file name. TODO: check if valid
        file naming convention
    start_date = &#39;2020-01-01&#39;
        the YYYY-MM-DD that the training data starts
    save_path: str = &#39;/Users/neel.parekh/Desktop/examples/&#39;
        where all of the outputs will live. TODO: Update all path managing to pathlib
    &#39;&#39;&#39;

    learning_rate: float = 1e-3
    environment: str = &#39;databricks&#39;
    experiment_name: str = None
    start_date: str = &#39;2020-01-01&#39;
    save_path: str = &#39;./models/&#39;

    @property
    def model_path(self) -&gt; str:
        &#39;&#39;&#39;
        Construct the model output file name as a property

        Parameters
        ----------

        Returns
        -------
        model_path: str
            where the model will be saved on the file system
        &#39;&#39;&#39;
        file_name = &#39;_&#39;.join(
            [str(item) for item in [
                    self.environment,
                    self.experiment_name,
                    self.start_date
                ]
            ]
        )
        model_path = self.save_path + file_name + &#39;.model&#39;
        return model_path</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="src.run_pipeline.ModelConfig.environment"><code class="name">var <span class="ident">environment</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="src.run_pipeline.ModelConfig.experiment_name"><code class="name">var <span class="ident">experiment_name</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="src.run_pipeline.ModelConfig.learning_rate"><code class="name">var <span class="ident">learning_rate</span> : float</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="src.run_pipeline.ModelConfig.save_path"><code class="name">var <span class="ident">save_path</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="src.run_pipeline.ModelConfig.start_date"><code class="name">var <span class="ident">start_date</span> : str</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="src.run_pipeline.ModelConfig.model_path"><code class="name">var <span class="ident">model_path</span> : str</code></dt>
<dd>
<div class="desc"><p>Construct the model output file name as a property</p>
<h2 id="parameters">Parameters</h2>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>model_path</code></strong> :&ensp;<code>str</code></dt>
<dd>where the model will be saved on the file system</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def model_path(self) -&gt; str:
    &#39;&#39;&#39;
    Construct the model output file name as a property

    Parameters
    ----------

    Returns
    -------
    model_path: str
        where the model will be saved on the file system
    &#39;&#39;&#39;
    file_name = &#39;_&#39;.join(
        [str(item) for item in [
                self.environment,
                self.experiment_name,
                self.start_date
            ]
        ]
    )
    model_path = self.save_path + file_name + &#39;.model&#39;
    return model_path</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="src" href="index.html">src</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="src.run_pipeline.DBs" href="#src.run_pipeline.DBs">DBs</a></code></h4>
<ul class="">
<li><code><a title="src.run_pipeline.DBs.EDW" href="#src.run_pipeline.DBs.EDW">EDW</a></code></li>
<li><code><a title="src.run_pipeline.DBs.REDSHIFT" href="#src.run_pipeline.DBs.REDSHIFT">REDSHIFT</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="src.run_pipeline.DatabaseConfig" href="#src.run_pipeline.DatabaseConfig">DatabaseConfig</a></code></h4>
<ul class="">
<li><code><a title="src.run_pipeline.DatabaseConfig.db_name" href="#src.run_pipeline.DatabaseConfig.db_name">db_name</a></code></li>
<li><code><a title="src.run_pipeline.DatabaseConfig.entities" href="#src.run_pipeline.DatabaseConfig.entities">entities</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="src.run_pipeline.ModelConfig" href="#src.run_pipeline.ModelConfig">ModelConfig</a></code></h4>
<ul class="two-column">
<li><code><a title="src.run_pipeline.ModelConfig.environment" href="#src.run_pipeline.ModelConfig.environment">environment</a></code></li>
<li><code><a title="src.run_pipeline.ModelConfig.experiment_name" href="#src.run_pipeline.ModelConfig.experiment_name">experiment_name</a></code></li>
<li><code><a title="src.run_pipeline.ModelConfig.learning_rate" href="#src.run_pipeline.ModelConfig.learning_rate">learning_rate</a></code></li>
<li><code><a title="src.run_pipeline.ModelConfig.model_path" href="#src.run_pipeline.ModelConfig.model_path">model_path</a></code></li>
<li><code><a title="src.run_pipeline.ModelConfig.save_path" href="#src.run_pipeline.ModelConfig.save_path">save_path</a></code></li>
<li><code><a title="src.run_pipeline.ModelConfig.start_date" href="#src.run_pipeline.ModelConfig.start_date">start_date</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>